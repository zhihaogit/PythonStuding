## 第六章:Linux文件与目录管理

### 6.1 目录与路径

#### 6.1.1 相对路径与绝对路径

#### 6.1.2 目录的相关操作

- `cd` 变化目录(change directory)
- `pwd` 显示当前的目录
- `mkdir` 创建一个新的目录
- `rmdir` 删除一个空的目录

#### 6.1.3 关于可执行文件路径的变量: $PATH

- `echo $PATH` 显示当前的 PATH
- 这个变量的内容是由一堆目录所组成的
- 每个目录之间用冒号`:`来隔开
- 每个目录是有顺序之分的
- 不同身份使用者默认的PATH不同，能够执行的指令也不同
- PATH可以被修改
- 使用绝对路径或相对路径直接执行某个指令的文件名，会比搜寻的PATH正确
- 指令应该放到正确的目录下
- 本目录(.)最好不要放到PATH中

### 6.2 文件与目录管理

#### 6.2.1 文件与目录的检视: ls

`ll`在大多数distribution的默认情况下都是 `ls -l`的意思

#### 6.2.2 复制、删除、移动: cp、rm、mv

- `cp` 复制文件或目录
- `rm` 移除文件或目录
- `mv` 移动文件与目录，或更名
  - 使用 `-u`来测试新旧文件，看是否需要搬运

#### 6.2.3 取得路径的文件名称与目录名称

- `basename` 取得最后的文件名
- `dirname` 取得的目录名

### 6.3 文件内容查阅

- `cat` 由第一行开始显示文件内容
- `tac` 由最后一行开始显示
- `nl` 显示的时候，输出行号
- `more` 分页显示文件内容
- `less` 分页显示文件内容，可向前翻页
- `head` 只看头几行
- `tail` 只看最后几行
- `od` 以二进制的方式读取文件内容

#### 6.3.1 直接检视文件内容

- `cat` Concatenate(连续)的简写
  - 将一个文件的内容连续打印在屏幕上
  - `cat [-AbEnTv]`
- `tac` 由最后一行到第一行显示在屏幕上
- `nl` 添加行号打印
  - `nl [-bnw]` 文件

#### 6.3.2 可翻页检视

- `more` 分页翻动
  - 空格键：向下翻页
  - Enter：向下翻一行
  - /字串：向下搜索输入的字符
  - `:f`：立刻显示出文件名及目前显示的行数
  - `q`：退出
  - `b或[ctrl]-b`：向回翻页，只对文件有效，对管线无效
- `less` 分页翻动，man指令就是调用`less`来显示说明文档
  - 空格键：向下翻页
  - `[pagedown]`：向下翻页
  - `[pageup]`：向上翻页
  - `/字串`：向下搜索输入的字符
  - `?字串`：向上搜索输入的字符
  - `n`：重复前一次搜索
  - `N`：反向的重复前一次搜索
  - `g`：前进到数据的第一行
  - `G`：前进到数据的最后一行
  - `q`：退出

#### 6.3.3 数据撷取

- `head` 取出前面几行
  - head [-n number] 文件
  - -n 后面接数字，代表显示几行
  - 默认显示前十行
  - eg: head -n 20 /etc/man_db.conf
  - eg: head -n -100 /etc/man_db.conf (除了最后100行，其他都显示)
- `tail` 取出最后几行
  - tail [-n number] 文件
  - -n  后面数字，代表显示几行
  - -f  持续侦测后面的文件
  - 默认显示最后十行
  - eg: tail -n 20 /etc/man_db.conf
  - eg: tail -n +100 /etc/man_db.conf (只列出100行之后的内容)

#### 6.3.4 非纯文本文件：od

- `od [-t TYPE] 文件`
- 可执行文件通常是 binary file，od读取不会出现乱码

#### 6.3.5 修改文件时间或创建新文件：touch

- 三个主要的时间参数
  - `modification time (mtime)` 文件的内容数据变更时，更新该时间
  - `status time (ctime)` 文件的状态（权限或属性）变更时，更新该时间
  - `access time (atime)` 文件的内容被取用时，更新该时间
- `touch [-acdmt] 文件`
  - -a 仅修改 atime
  - -c 仅修改 ctime，文件不存在则不创建新文件
  - -d 后面可以接欲修订的日期而不用当前的日期，等同 `—date="日期或时间"`
  - `-m` 仅修改 mtime
  - -t 后面可以接欲修订的日期而不用当前的日期，格式为 `[YYYYMMDDhhmm]`
- 使用场景
  - 创建一个 空文件
  - 将某个文件日期修改为当前 (mtime和 atime)

### 6.4 文件与目录的默认权限与隐藏权限

#### 6.4.1 文件默认权限：umask

unmaks就是指定 目前使用者再创建文件或目录时候的权限默认值

- 查阅的方式
  - `umask`
  - `umask -S(Symbolic)`
- 设置的方式
  - 直接 umask number
  - eg: `umask 002`

#### 6.4.2 文件隐藏属性

- `chattr` 设置文件隐藏属性
  - `chattr [+-=][ASacdistu] 文件或目录名称` 
- `lsattr` 显示文件隐藏属性

#### 6.4.3 文件特殊权限：SUID,SGID,SBIT

- Set UID
  - 当 s 出现在文件拥有者的 x权限上时，就被称为Set UID，简称为 SUID的特殊权限
  - 限制与功能
    - SUID权限仅对二进制程序(binary program)有效，不能用在 shell script上
    - 执行者对于该程序需要有 x权限
    - 只在执行该程序的过程中有效(run-time)
    - 执行者将具有该程序的拥有者(owner)权限
- Set GID
  - 当 s 出现在群组的 x权限上时，就被成为Set GID，SGID
  - 功能
    - SGID对二进制程序有用
    - 可以是针对文件或目录进行设置
    - 程序执行者对于该程序来说，需要具备 x权限
    - 执行者在执行的过程中将获得该程序群组的支持
- Sticky Bit
  - SBIT 只针对目录有效，对文件没有效果
  - 对目录的作用
    - 当使用者对于此目录具有w,x权限，亦具有写入的权限
    - 当使用者在该目录下创建文件或目录时，仅有自己与 root才有权利删除
- SUID/SGID/SBIT 权限设置
  - 三个数字组合
    - 4 为 SUID
    - 2 为 SGID
    - 1 为 SBIT
  - eg: `chmod 4755 filename` , 4 为特殊权限的值之和
  - 大写的S/T，具有空的SUID/SGID权限

#### 6.4.4 观察文件类型: file

- 可以知道某个文件的基本数据
- 该文件没有使用到动态函数库(share library)
- eg: `file ~/.bashrc`

### 6.5 指令与文件的搜寻

#### 6.5.1 指令文件名的搜寻

- `which` 寻找可执行文件
- `which [-a] command`
- `-a` 将所有由 PATH目录中可以找到的指令列出，而不止第一个被找到的
- 根据 PATH环境变量所规范的路径，去搜寻可执行的文件名

#### 6.5.2 文件文件名的搜寻

- `whereis` 由一些特定的目录中寻找文件文件名
  - `whereis [-bmsu] 文件或目录名`
- `locate/updatedb`
  - `locate [-ir] keyword`
  - 寻找的数据由 已创建的数据库/var/lib/mlocate/ 里面的数据所搜寻到，不是直接搜索硬盘
  - 数据库的创建默认每天执行一次，有可能会找不到文件
  - `updatedb` 会读取 /etc/updatedb.conf这个配置，然后去搜寻文件名，最后更新数据库文件
- `find`
  - `find [PATH] [option] [action]`
  - 跟时间有关的选项
    - +4 代表大于等于 5天前的文件名：ex>find /var -mtime +4
    - -4 代表小于等于 4天内的文件文件名：ex>find /var -mtime -4
    - 4 代表 4-5那一天的文件文件名：ex>find /var -mtime 4
  - 跟使用者或群组名称有关的参数
  - 与文件权限及名称有关的参数
